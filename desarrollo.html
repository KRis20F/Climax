<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentación del Código</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; padding: 20px; }
        code { background: #f4f4f4; padding: 2px 5px; border-radius: 5px; }
        pre { background: #f4f4f4; padding: 10px; border-radius: 5px; overflow-x: auto; }
        h1, h2, h3 { color: #333; }
    </style>
</head>
<body>
    <h1>Documentación del Código de la Aplicación del Clima</h1>

    <h2>Descripción</h2>
    <p>Este proyecto es una aplicación web interactiva que permite a los usuarios obtener información meteorológica y visualizar imágenes de diversas localidades en España. Incluye funcionalidades como selección dinámica de ubicaciones (comunidades autónomas, provincias y poblaciones), geolocalización y búsqueda por voz.</p>

    <h2>Secciones del Código</h2>

    <h3>1. Variables y Selección de Elementos del DOM</h3>
    <p>Se utilizan selectores de DOM para capturar los elementos clave de la interfaz, que permiten la interacción del usuario:</p>
    <pre><code>// Elementos para seleccionar ubicaciones
const ccaaSelect = document.getElementById("ccaa");
const provinciaSelect = document.getElementById("provincia");
const poblacionSelect = document.getElementById("poblacion");
const imageContainer = document.getElementById("image-container");

// Elementos para funcionalidades adicionales
const formulario = document.getElementById("searchForm");
const geoButton = document.getElementById("geoButton");
const voiceButtonCCAA = document.getElementById("voiceSearchCCAA");
const voiceButtonProvincia = document.getElementById("voiceSearchProvincia");
const voiceButtonPoblacion = document.getElementById("voiceSearchPoblacion");

// Variables globales
let map; // Contendrá la instancia del mapa Leaflet
const WEATHER_API_KEY = 'TU_API_KEY'; // Clave de la API para obtener información del clima</code></pre>

    <h3>2. Funciones para obtener datos</h3>
    <p>Estas funciones obtienen los datos dinámicamente desde un repositorio JSON:</p>
    <ul>
        <li><strong>getComunidadesAutonomas:</strong> Recupera las comunidades autónomas y las añade al select.</li>
        <li><strong>getProvincias:</strong> Filtra y añade las provincias según la comunidad autónoma seleccionada.</li>
        <li><strong>getPoblaciones:</strong> Filtra y añade las poblaciones según la provincia seleccionada.</li>
    </ul>
    <pre><code>async function getComunidadesAutonomas() { ... }
async function getProvincias() { ... }
async function getPoblaciones() { ... }</code></pre>

    <h3>3. Evento Submit del Formulario</h3>
    <p>El formulario captura el evento <code>submit</code>, evitando el comportamiento por defecto, y realiza dos acciones principales:</p>
    <ol>
        <li>Obtiene el clima para la población seleccionada mediante la API de OpenWeatherMap.</li>
        <li>Busca imágenes relacionadas usando la API de Wikimedia.</li>
    </ol>
    <pre><code>formulario.addEventListener("submit", async (event) => { ... });</code></pre>

    <h3>4. Funcionalidad de Geolocalización</h3>
    <p>El botón de geolocalización usa la API de Geolocation para obtener las coordenadas del usuario. Luego, llama a la API de OpenStreetMap para determinar la ciudad más cercana y mostrar su ubicación en un mapa interactivo de Leaflet:</p>
    <pre><code>geoButton.addEventListener("click", getLocation);

function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition, showError);
    } else {
        alert("La geolocalización no es soportada por este navegador.");
    }
}
</code></pre>

    <h3>5. Reconocimiento de Voz</h3>
    <p>La funcionalidad de reconocimiento de voz permite a los usuarios seleccionar ubicaciones usando comandos hablados. Se normalizan las cadenas para hacer coincidir las palabras reconocidas con las opciones disponibles:</p>
    <pre><code>voiceButtonCCAA.addEventListener("click", () => startVoiceRecognition("ccaa"));

function startVoiceRecognition(type) {
    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.lang = "es-ES";
    recognition.start();

    recognition.onresult = function (event) {
        const transcript = normalizeText(toPascalCase(event.results[0][0].transcript));
        // Lógica para seleccionar la opción correcta...
    };
}</code></pre>

    <h2>Conclusión</h2>
    <p>Este código integra múltiples tecnologías modernas: obtención dinámica de datos desde JSON, consumo de APIs (OpenWeatherMap, Wikimedia, OpenStreetMap), geolocalización del navegador y reconocimiento de voz. El resultado es una aplicación interactiva y accesible para explorar el clima y las imágenes de distintas localidades de España.</p>

</body>
</html>
